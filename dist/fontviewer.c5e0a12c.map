{"version":3,"sources":["index.js"],"names":["glyphs","document","querySelector","color","fontFamily","fonts","querySelectorAll","forEach","el","addEventListener","selectFont","event","classList","remove","target","add","fontName","textContent","includes","style","opentype","load","err","font","console","log","createElement","type","appendChild","createTextNode","head","showFont","push","showArrayBuffer","ab","parse","supported","fontList","length","file","files","arrayReader","FileReader","readAsArrayBuffer","onload","result","localStorage","setItem","abToStr","visibility","innerHTML","charCodes","Object","values","filter","glyph","unicode","undefined","map","g","names","inner","charCode","String","fromCharCode","join","fontFace","window","FontFace","showDetails","li","dataset","details","unicodeBox","decimalBox","htmlCodeBox","charBox","setTimeout","top","offsetTop","left","offsetLeft","parseInt","toString","slice","buf","apply","Uint16Array","strToAb","str","ArrayBuffer","bufView","i","strLen","charCodeAt","key","value","getItem"],"mappings":"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","file":"fontviewer.c5e0a12c.map","sourceRoot":"..","sourcesContent":["const glyphs = document.querySelector('.glyphs');\nlet color = '#3e3e3e';\nlet fontFamily;\nconst fonts = [];\n\ndocument.querySelectorAll('.fonts .font').forEach(el => el.addEventListener('click', selectFont))\n\nfunction selectFont(event) {\n  document.querySelectorAll('.fonts .font').forEach(el => el.classList.remove('selected'))\n  event.target.classList.add('selected');\n  const fontName = event.target.textContent;\n  if (fonts.includes(fontName)) {\n    glyphs.style.fontFamily = fontName;\n    return;\n  }\n  opentype.load(`/fonts/${fontName}-Regular.ttf`, (err, font) => {\n    if (err) {\n      console.log(err);\n    }\n    const style = document.createElement('style');\n    style.type = 'text/css';\n    style.appendChild(document.createTextNode(`\n        @font-face {\n          font-family: ${fontName};\n          src: url(/fonts/${fontName}-Regular.ttf);\n        }\n      `));\n    document.head.appendChild(style);\n    showFont(font);\n    fonts.push(fontName);\n  });\n}\n\nfunction showArrayBuffer(ab) {\n  let font;\n  try {\n    font = opentype.parse(ab);\n  } catch (err) {\n    font = { supported: false };\n  }\n  const fontFamily = showFont(font);\n  const fontList = document.querySelectorAll('.fonts .font');\n  fontList[fontList.length-1].addEventListener('click', selectFont)\n  fontList.forEach(el => el.classList.remove('selected'))\n  fontList[fontList.length-1].classList.add('selected')\n}\n\ndocument.querySelector('.file-reader').addEventListener('change', function(event) {\n  const file = event.target.files[0];\n  if (file) {\n    const arrayReader = new FileReader();\n    arrayReader.readAsArrayBuffer(file);\n    arrayReader.onload = function(event) {\n      showArrayBuffer(event.target.result);\n\n      localStorage.setItem(fontFamily, abToStr(event.target.result));\n    }\n  }\n});\n\nfunction showFont(font) {\n  document.querySelector('.details').style.visibility = 'hidden';\n  if (!font.supported) {\n    fontFamily = '\"Helvetica Neue\", Helvetica, Arial';\n    glyphs.style.color = 'tomato';\n    glyphs.style.fontFamily = fontFamily;\n    glyphs.innerHTML = 'Invalid font file or unsupported format';\n    return;\n  }\n  const charCodes = Object.values(font.glyphs.glyphs).filter(glyph => glyph.unicode !== undefined).map(g => g.unicode)\n  fontFamily = Object.values(font.names.fontFamily)[0];\n\n  const inner = charCodes.map(charCode => `<span class=\"glyph\" data-unicode=\"${charCode}\">${String.fromCharCode(charCode)}</span>`).join('\\t');\n  glyphs.innerHTML = inner;\n\n  const fontFace = new window.FontFace(fontFamily, event.target.result);\n  document.fonts.add(fontFace);\n\n  document.querySelectorAll('.glyph').forEach(g => {\n    g.addEventListener('mousemove', showDetails);\n    g.addEventListener('touchmove', showDetails);\n  });\n\n  glyphs.style.color = color;\n  glyphs.style.fontFamily = fontFamily;\n\n  const li = document.createElement('li');\n  li.classList.add('font');\n  li.innerHTML = fontFamily;\n  fonts.push(fontFamily);\n  document.querySelector('.fonts').appendChild(li);\n\n  return fontFamily;\n}\n\nfunction showDetails(event) {\n  const unicode = event.target.dataset.unicode;\n  const details = document.querySelector('.details');\n  const unicodeBox = details.querySelector('.unicode');\n  const decimalBox = details.querySelector('.decimal');\n  const htmlCodeBox = details.querySelector('.html');\n  const charBox = details.querySelector('.char');\n\n  details.style.visibility = 'hidden';\n  details.classList.remove('trans');\n  setTimeout(() => {\n    details.style.visibility = 'visible';\n    details.style.top = `${event.target.offsetTop-50}px`;\n    details.style.left = `${event.target.offsetLeft-15}px`;\n    unicodeBox.innerHTML = '0x' + ('0000' + parseInt(unicode).toString(16)).slice(-4);\n    decimalBox.innerHTML = unicode;\n    htmlCodeBox.innerHTML = `&amp;#${unicode};`;\n    charBox.style.fontFamily = fontFamily;\n    charBox.innerHTML = String.fromCharCode(unicode);\n\n    details.classList.add('trans');\n\n    details.addEventListener('mouseleave', () => details.style.visibility = 'hidden');\n  }, 1);\n}\n\nfunction abToStr(buf) {\n  return String.fromCharCode.apply(null, new Uint16Array(buf));\n}\n\nfunction strToAb(str) {\n  var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char\n  var bufView = new Uint16Array(buf);\n  for (var i=0, strLen=str.length; i < strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n\nfor (var i = 0; i < localStorage.length; i++) {\n  const key = localStorage.key(i);\n  const value = localStorage.getItem(key);\n  showArrayBuffer(strToAb(value));\n  console.log('Key: ' + key);\n}\n"]}